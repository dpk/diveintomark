<!DOCTYPE HTML>
<html lang=en>
<head>
<meta charset=utf-8>
<title>Draconian error handling: still the worst idea ever [dive into mark]</title>
<link rel=alternate type=application/atom+xml href=/web/20110811111736/http://diveintomark.org/feed/>
<link rel=me type=text/html href=/web/20110811111736/http://www.google.com/profiles/pilgrim>
<link rel=author href=/web/20110811111736/http://diveintomark.org/about>
<link rel=search type=application/opensearchdescription+xml href=/web/20110811111736/http://wearehugh.com/public/2006/09/opensearch-full.xml title="dive into mark">
<link rel="shortcut icon" href=/web/20110811111736im_/http://diveintomark.org/favicon.ico>
<link rel=prev href="/web/20110811111736/http://diveintomark.org/archives/2008/03/07/iphone-gpl" title="Can GPL iPhone apps exist?">
<link rel=next href="/web/20110811111736/http://diveintomark.org/archives/2008/03/10/priorities-2" title="Priorities">
<link rel=up href="/web/20110811111736/http://diveintomark.org/archives#p1761" title="March 2008">
<link rel="alternate" type="application/rss+xml" title="dive into mark &raquo; Draconian error handling: still the worst idea ever Comments Feed" href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned/feed" />
<link rel='index' title='dive into mark' href='/web/20110811111736/http://diveintomark.org/' />
<link rel='prev' title='Can GPL iPhone apps exist?' href='/web/20110811111736/http://diveintomark.org/archives/2008/03/07/iphone-gpl' />
<link rel='next' title='Priorities' href='/web/20110811111736/http://diveintomark.org/archives/2008/03/10/priorities-2' />
<link rel='canonical' href='/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned' />
<link rel='shortlink' href='/web/20110811111736/http://diveintomark.org/?p=1761' />
<meta name="description" content="My therapist says I shouldn’t rely so much on external validation.">
<meta name="keywords" content="markup,mu">
<link href="/web/20110811111736cs_/http://fonts.googleapis.com/css?family=Lora" rel=stylesheet>
<style type=text/css>
/*dive into minimalism(c)2010 Mark Pilgrim,MIT-licensed including graphics*/
html{background:white url(/web/20110811111736/http://wearehugh.com/m.jpg) no-repeat bottom right;color:black}
body{font:normal medium Lora,serif;margin:1.75em auto;width:40em;line-height:1.75;word-spacing:0.1em}
em,i,blockquote{font-family:Lora,serif;font-style:oblique}
strong,b{font-family:Lora,serif;}
pre,code,var,samp,kbd,tt{font-family:monospace}
h2,h3{font-weight:bold}
.c{font-family:'Arial Unicode MS',FreeSerif,'DejaVu Sans',sans-serif}
a{background:transparent;text-decoration:none;border-bottom:1px dotted}
a:hover{border-bottom:1px solid}
a:link{color:#1b67c9}
a:visited{color:darkorchid}
h1 a,h2 a,h3 a,#nav a,.punch a{color:inherit !important}
abbr,.p{border:0;letter-spacing:0.1em;text-transform:lowercase;font-variant:small-caps}
h1,h2,h3,p,ul,ol,#nav{margin:1.75em 0}
h1,h2,h3{font-size:medium}
h1,h2{display:inline}
h1{font-weight:normal}
pre,tt{white-space:pre-wrap;font-size:medium;line-height:2.154}
cite{font-style:normal}
img{border:0}
.framed{border:1px solid}
.cl,#arc th,#arc td,.punch p{list-style:none;margin:0;padding:0}
.cl li{margin-bottom:-1px;border-bottom:1px dotted;overflow:hidden}
.sig,.tb,.pb,blockquote{font-size:small;line-height:2.154;margin:2.154em 0;padding:0}
blockquote{font-style:oblique;border-left:1px dotted;margin-left:2.154em;padding-left:2.154em}
blockquote p{margin:2.154em 0}
.tb,.pb{margin-top:0;padding:2.154em 0}
.sig,.punch,#arc th{text-align:right}
.f,.c{text-align:center;clear:both}
#comment,#arc{width:100%}
#comment{height:14.6em;margin:0;line-height:2.154}
.me{background:papayawhip;color:black;padding:1.75em 1.75em 0 1.75em;border-top:1px dotted;margin-top:-2px}
.me>p:first-child{margin-top:0}
.punch{float:right;font-size:x-small;margin:0 0 1.75em 1.75em;line-height:1.75}
#nav + .punch + p:first-letter{float:left;color:gainsboro;padding:0.11em 4px 0 0;font:normal 4em/0.68 serif}
#arc th{padding:0 1.75em 0 0;vertical-align:baseline}
#arc{border-collapse:collapse}
figure{display:block;text-align:center;margin:1.75em 0}
figure img{display:block;margin:0 auto}
</style>
<script>_gaq=[['_setAccount','UA-7434570-2'],['_trackPageview'],['_trackPageLoadTime']];(function(){var g=document.createElement('script');g.src='//www.google-analytics.com/ga.js';g.setAttribute('async','true');document.documentElement.firstChild.appendChild(g);})();</script>
<link rel=canonical href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned">
</head>
<body>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/diveintomark.org\/archives\/2008\/03\/09\/no-fury-like-dracon-scorned";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "11";
var displayMonth = "Aug";
var displayYear = "2011";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px; z-index:9000;">
<div id="wm-ipp-inside" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20110811111736" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20110514121207/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="14 May 2011"><strong>MAY</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 11:17:36 Aug 11, 2011">AUG</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20111110151919/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="10 Nov 2011"><strong>NOV</strong></a>
		                
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20110514121207/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned" title="12:12:07 May 14, 2011" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 11:17:36 Aug 11, 2011">11</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20111110151919/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned" title="15:19:19 Nov 10, 2011" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0"/></a>
		                
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20100620081707/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="20 Jun 2010"><strong>2010</strong></a>
		                
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 11:17:36 Aug 11, 2011">2011</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2012
                       
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20110811111736*/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>14 captures</strong></a>
           <div style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">12 Mar 08 - 10 Nov 11</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000000000000_2004:-1:000000000000_2005:-1:000000000000_2006:-1:000000000000_2007:-1:000000000000_2008:-1:002021000110_2009:-1:001000000000_2010:-1:000001000011_2011:7:000010010010_2012:-1:000000000000_2013:-1:000000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

<div id=nav><h1><a accesskey=1 href=/web/20110811111736/http://diveintomark.org/>dive into mark</a></h1> &#8227;
<a href="/web/20110811111736/http://diveintomark.org/archives#p1761">March 9, 2008</a> &#8227;
<h2>Draconian error handling: still the worst idea ever</h2> (<a href="/web/20110811111736/http://diveintomark.org/tag/markup" rel="tag">markup</a>, <a href="/web/20110811111736/http://diveintomark.org/tag/mu" rel="tag">mu</a>)</div>
<p>Even the experts can&#8217;t get it right 100% of the time.</p>

<p><img alt="[screenshot of xml error on intertwingly.net]" src="/web/20110811111736im_/http://wearehugh.com/public/2008/03/draconian-640.png" width="640" height="280"></p>

<p><small>screenshot taken at 10:29 PM on March 8, 2008.</small></p>

<p>For the record, my site is valid HTML 5, except the parts that aren&#8217;t.  My therapist says I shouldn&#8217;t rely so much on external validation.</p>
<p class=c>&#167;

<h3 id=comments>Fifty three comments here (<a href=/web/20110811111736/http://diveintomark.org/recentcomments>latest comments</a>)</h3>
<ol class=cl>
<li id="comment-11412"><p>Oh, Mark, but it&#8217;s better than that.</p>
<p>The offending &lt;meta&gt; tag, which made the page ill-formed?</p>
<p>&lt;meta http-equiv=&#8221;x-ua-compatible&#8221; content=&#8221;ie=7&#8243;&gt;</p>
<p>Microsoft: the root of all evil.</p>
<p>(Or maybe it&#8217;s Sam&#8217;s new Mac-mini.)</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11412" title="March 9, 2008 @ 11:42 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li class=me id="comment-11413"><p>Surely you mean &#8220;the love of Microsoft is the root of all evil.&#8221; :)</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://diveintomark.org/' rel='external nofollow' class='url'>Mark</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11413" title="March 9, 2008 @ 11:53 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11415"><p>I was about to write a comment saying &#8220;I wonder how it&#8217;s possible that you caught that, I can&#8217;t believe Sam&#8217;s site would be broken for more than 10 seconds&#8230;&#8221;&#8212;only to visit intertwingly.net and discover it still broken, as of now.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://justinsomnia.org/' rel='external nofollow' class='url'>Justin Watt</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11415" title="March 10, 2008 @ 1:53 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11416"><p>It&#8217;s just data.</p>
<p class=sig>&#8212;&#8201;<cite>Arien</cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11416" title="March 10, 2008 @ 3:32 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li class=pb id="comment-11417"><cite><a href='/web/20110811111736/http://dustman.wordpress.com/2008/03/10/todays-selected-reads-5/' rel='external nofollow' class='url'>Today&#8217;s selected reads &laquo; Dustman&#8217;s Weblog</a></cite>&#160;(pingback)</li>
<li id="comment-11418"><p>The great thing about XML&#8217;s well-formedness requirements is that this kind of thing can&#8217;t happen, because the author would catch this kind of error straight away. With HTML, and its lax parsing rules, this kind of error isn&#8217;t caught unless the author runs a conformance checker, which is why the Web is in such a horrendous state (93% syntactically non-conforming content, according to my multibillion file study).</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://ln.hixie.ch/' rel='external nofollow' class='url'>Ian Hickson</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11418" title="March 10, 2008 @ 4:42 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11419"><p>Heh. That reminded me of a similarly ironic screen shot I made a few years ago (not from a celebrity&#8217;s web site, but I still find it very funny): <a href="/web/20110811111736/http://boinkor.net/misc/terrible-xml-error.png" rel="nofollow">http://boinkor.net/misc/terrible-xml-error.png</a></p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://boinkor.net/' rel='external nofollow' class='url'>Andreas Fuchs</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11419" title="March 10, 2008 @ 5:07 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11420"><p>@Arien: Wow, that really made me laugh.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://bytesexual.org/' rel='external nofollow' class='url'>Noah Slater</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11420" title="March 10, 2008 @ 5:16 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11421"><p>Ian Hickson, surely you jest?</p>
<p><a href="/web/20110811111736/http://diveintomark.org/archives/2004/01/14/thought_experiment" rel="nofollow">http://diveintomark.org/archives/2004/01/14/thought_experiment</a></p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://bytesexual.org/' rel='external nofollow' class='url'>Noah</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11421" title="March 10, 2008 @ 5:19 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11422"><p>lol, that closing line is epic.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://firasd.org/' rel='external nofollow' class='url'>Firas</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11422" title="March 10, 2008 @ 7:15 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11423"><p>Typical Hixie… :) I mean, it&#8217;s never happened, ever.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://gsnedders.com/' rel='external nofollow' class='url'>Geoffrey Sneddon</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11423" title="March 10, 2008 @ 8:03 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11424"><p>Snideness aside, what Ian says is exactly true&#8230; if IE handled XHTML, that is.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://blog.codedread.com/archives/2008/03/09/more-importantly/' rel='external nofollow' class='url'>Jeff Schiller</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11424" title="March 10, 2008 @ 8:51 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11425"><p>Heh. Mark, I’ll change camps if anyone ever catches <em>me</em> with a well-formedness error. (Not having implemented comments yet makes this easier for me to say, admittedly, but the way my weblog works does completely rule out mistakes of the the sort that Sam made in this instance. And I fully intend to preserve that property across any features I add.)</p>
<p>As an aside, the way that Gecko deals with XML parsing errors is unnecessarily user hostile. Other browsers demonstrate that it’s very possible to bow out just a little more gracefully. Of course, the kind of screenshot they yield is lousy for arguing a point…</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://plasmasturm.org/' rel='external nofollow' class='url'>Aristotle Pagaltzis</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11425" title="March 10, 2008 @ 10:01 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li class=me id="comment-11426"><p>> Of course, the kind of screenshot they yield is lousy for arguing a point&#8230;</p>
<p>In this case, wouldn&#8217;t it have been the same result?  The error was within the head element, so they wouldn&#8217;t render any of the body.</p>
<p>That said, Mozilla&#8217;s error handling of this case is like a vestige of another age, when some True Believer thought exactly what Ian said above (but without the sarcasm) and intentionally made the error display as unfriendly as possible.  &#8220;Fail early and ugly,&#8221; and all that.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://diveintomark.org/' rel='external nofollow' class='url'>Mark</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11426" title="March 10, 2008 @ 10:14 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11427"><p>Maybe someone can put some focus on <a href="/web/20110811111736/http://bugzilla.mozilla.org/show_bug.cgi?id=418305">Bug 418305</a>&#8230;</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://blog.codedread.com/' rel='external nofollow' class='url'>Jeff Schiller</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11427" title="March 10, 2008 @ 10:36 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11428"><p>Hey, at least in the previous age, when Mozilla failed on bad XML they would fail ugly.  </p>
<p>In the current era, if your live bookmark points at an invalid feed, you get neither data nor an error message.</p>
<p class=sig>&#8212;&#8201;<cite>Kevin H</cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11428" title="March 10, 2008 @ 10:41 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11430"><p>&gt; I’ll change camps if anyone ever catches <em>me</em> with a well-formedness error</p>
<p><a href="/web/20110811111736/http://plasmasturm.org/%ef%bf%bf">Really?</a></p>
<p class=sig>&#8212;&#8201;<cite>Philip Taylor</cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11430" title="March 10, 2008 @ 5:40 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li class=pb id="comment-11436"><cite><a href='/web/20110811111736/http://realtech.burningbird.net/general/run-for-the-web/' rel='external nofollow' class='url'>Bb&#39;s RealTech | Run for the Web</a></cite>&#160;(pingback)</li>
<li id="comment-11437"><p>Philip:</p>
<p>Yeah, the error pages are completely outside the code that can prevent malformed content from getting out. I should probably serve them as <code>text/html</code> as they’re just SSIs. I could get mod_include to URI-encode the variable <em>instead</em> of entity-encoding it, but that would just let you trip it with bare ampersands et al; I see no way to make mod_include encode both ways. Pointers welcome. Whenever I implement comments I’ll have the necessary code on the server and I’ll take care of it properly then.</p>
<p>(There are analogous known bugs at other strata too; f.ex. you can try to bring up <code>/log/999999/</code> and it will return an empty page with status 200 OK instead of throwing a 404 back at you.)</p>
<p>Mark:</p>
<p>&gt; In this case, wouldn’t it have been the same result?</p>
<p>True.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://plasmasturm.org/' rel='external nofollow' class='url'>Aristotle Pagaltzis</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11437" title="March 11, 2008 @ 1:17 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li class=me id="comment-11439"><p>@Aristotle: so, you&#8217;ll change camps if anyone ever catches you with a well-formedness error on the pages that you already know are well-formed?  That doesn&#8217;t seem as impressive as your original claim.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://diveintomark.org/' rel='external nofollow' class='url'>Mark</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11439" title="March 11, 2008 @ 4:44 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11442"><p>If you limit it to static content, then clearly it&#8217;s trivial to ensure well-formedness &#8211; just generate all the pages offline, and only switch them into the live system after testing with a validator.</p>
<p>Most people want to generate content dynamically, and then <a href="/web/20110811111736/http://blog.codedread.com/?s=%00">it</a> <a href="/web/20110811111736/http://golem.ph.utexas.edu/cgi-bin/MT-3.0/mt-search.cgi?Template=%00">gets</a> <a href="/web/20110811111736/http://realtech.burningbird.net/?s=%00">harder</a> to ensure well-formedness in all cases.</p>
<p>Looking at 130K randomly selected pages from <a href="/web/20110811111736/http://dmoz.org/">dmoz.org</a>, 39 are served as application/xhtml+xml. Looking at the first few of those, <em><a href="/web/20110811111736/http://hipocampo.org/%3C">every</a> <a href="/web/20110811111736/http://www.keks.de/kontakt?subject=%00">single</a> <a href="/web/20110811111736/http://nosicalanguage.free.fr/index.php?title=%00">site</a> <a href="/web/20110811111736/http://olaf-bosch.de/switcher.xhtml?set=%22%3F%3E">gets</a> <a href="/web/20110811111736/http://new.piv.nu/%ef%bf%bf">it</a> <a href="/web/20110811111736/http://stattreisenberlin.de/berlin/newsletter.html?name=%00">wrong</a></em>.</p>
<p>Some of these sites just need to remember to escape any user-input strings, the same as in text/html. The rest could be fixed by updating their HTML escaping function to do <code>s/[^\x09\x0A\x0D\x20-\x{D7FF}\x{E000}-\x{FFFD}\x{10000}-\x{10FFFF}]/\x{FFFD}/g</code>, but that appears to be too much for anyone to manage.</p>
<p class=sig>&#8212;&#8201;<cite>Philip Taylor</cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11442" title="March 11, 2008 @ 8:37 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11444"><p>Thanks Philip.</p>
<p>Yes, it&#8217;s true that my WP blog does not yet support invalid XML characters in comments or search terms.  I hope that either I will have time to patch my WP install or that it will be fixed in a near-future version of the WP product.  Until that time, I&#8217;ll just continue to manually monitor my blog comments as I do on a day-to-day basis.</p>
<p>I believe such incidents have only been people trying to break my blog and not people really trying to get access to the content.  Could someone describe a scenario where a normal user might encounter such an error?  Are there scenarios where these search queries might be used maliciously?  Thanks.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://blog.codedread.com/' rel='external nofollow' class='url'>Jeff Schiller</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11444" title="March 11, 2008 @ 11:51 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11445"><p>Mark:</p>
<p>Yeah, anything I say now is not going to sound very convincing. The site is a hodgepodge; the weblog part is XML-based, but the rest is old crud that I never got bothered enough to integrate (I’d have to shave a Matryoshka yak to bring it all together). I didn’t even think of those vestiges when I wrote the previous comment. Sucks.</p>
<p>Let’s put it this way: I am confident that I’ll never have a well-formedness error in the part of the site that I constantly change.</p>
<p>And I continue to be confident about getting the parts right that take user input; whenever I write them…</p>
<p>Philip:</p>
<p>It’s not really any different from static content when you accept user input: make sure the user input passes muster before accepting it. If it doesn’t, ask the user to fix it while they’re still around to do so. To be less hostile, grind it through HTMLTidy/TagSoup/whatever and ask them if the result looks correct. <em>Someone</em> will have to error-correct it; best do that as far upstream as possible, ideally where the source has a chance to either consent to that interpretation or provide the right fix.</p>
<p>Seems obvious to me… we’ll see if I can walk the walk.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://plasmasturm.org/' rel='external nofollow' class='url'>Aristotle Pagaltzis</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11445" title="March 11, 2008 @ 11:51 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11446"><p>&gt; Could someone describe a scenario where a normal user might encounter such an error?</p>
<p>When submitting feedback? Easily: Trackbacks have no defined encoding. If you sent an ISO-8859-1 trackback which happens to contain what would be a non-character if it were treated as UTF-8, then you could hit it then. That is: &#8220;?&gt;. Why might someone write this? Well, let&#8217;s have a completely valid line of PHP: .</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://gsnedders.com/' rel='external nofollow' class='url'>Geoffrey Sneddon</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11446" title="March 11, 2008 @ 12:26 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11447"><p>Thanks, I currently hide my trackback and xmlrpc PHP files.  Let me modify the question:</p>
<p>Could someone describe a scenario where a normal user might encounter such an error when entering a comment on the website or search query?  Is there any way to maliciously inject PHP via the comment mechanism within WordPress?</p>
<p>Sorry, I&#8217;m still very new to this encoding stuff&#8230; and sorry to be hi-jacking Mark&#8217;s blog for WordPress-specific questions.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://blog.codedread.com/' rel='external nofollow' class='url'>Jeff Schiller</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11447" title="March 11, 2008 @ 12:35 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li class=me id="comment-11449"><p>Yeah, SixApart really screwed the pooch on Trackback.  Modern implementations send encoding information in HTTP headers (what a concept!), but if it&#8217;s missing or wrong, you&#8217;re still screwed.  <a href="/web/20110811111736/http://chardet.feedparser.org/" rel="nofollow">http://chardet.feedparser.org/</a> may help, but it&#8217;s best at Eastern European and CJK languages, not distinguishing win-1252 from iso-8859-1.</p>
<p>@Jeff: don&#8217;t worry, you&#8217;re totally on-topic.  Aristotle said his system is based on XML; dunno if that means actually serializing a DOM though.  WordPress and MT (and Sam&#8217;s site, for that matter) are based on string templates, escaping functions, and faith.  Pit that against XML&#8217;s error handling, and XML wins every time.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://diveintomark.org/' rel='external nofollow' class='url'>Mark</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11449" title="March 11, 2008 @ 1:25 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11450"><p>Venus is based on serializating a DOM.  Even with that approach, you can have well formedness errors.  Invalid characters in a string, double dashes in a comment, element or attribute names with spaces in them&#8230;</p>
<p>P.S.  I would not say faith.  I have a very effective feedback loop mechanism in place. :-)</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://intertwingly.net/blog/' rel='external nofollow' class='url'>Sam Ruby</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11450" title="March 11, 2008 @ 3:43 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li class=pb id="comment-11451"><cite><a href='/web/20110811111736/http://lucumr.pocoo.org/cogitations/2008/03/11/178/' rel='external nofollow' class='url'>Lucumr Cogitations &raquo; Blog Archive</a></cite>&#160;(pingback)</li>
<li id="comment-11452"><p>Mark:</p>
<p>&gt; dunno if that means actually serializing a DOM though.</p>
<p>It does. The weblog resides in a master Atom feed that’s ground through XSLT to generate various views. Anything I build on top of that will work similarly.</p>
<p>As for how to handle Trackbacks, I think the correct answer is mu.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://plasmasturm.org/' rel='external nofollow' class='url'>Aristotle Pagaltzis</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11452" title="March 11, 2008 @ 4:16 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11453"><p>Philip said:</p>
<blockquote><p>Most people want to generate content dynamically, and then it gets harder to ensure well-formedness in all cases.</p></blockquote>
<p>Boooooring!</p>
<p>A two line fix in MT::Util-&gt;encode_html .</p>
<p><em>Surely</em>, one can find a more challenging example of ill-formedness.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11453" title="March 11, 2008 @ 5:57 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li class=pb id="comment-11455"><cite><a href='/web/20110811111736/http://blog.labnotes.org/2008/03/11/rounded-corners-194-if-it-helps-you-feel-better/' rel='external nofollow' class='url'>Labnotes &raquo; Rounded Corners - 194 (If it helps you feel better &#8230;)</a></cite>&#160;(pingback)</li>
<li id="comment-11456"><p>Dagnabit, I look away from the trainwreck for four years and absolutely nothing has changed. Why the hell are people[*] in 2008 *still* trying to deliver XHTML to the client? </p>
<p>Nurse, where are my pills?</p>
<p>[*] people who are not physicists</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://www.goer.org/Journal/' rel='external nofollow' class='url'>Evan Goer</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11456" title="March 12, 2008 @ 2:45 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11463"><p>I wrote</p>
<blockquote><p>Boooooring!<br />
A two line fix in MT::Util-&gt;encode_html .</p></blockquote>
<p>OK. I partially retract that.</p>
<p>My dividing line between boring and interesting is whether only the miscreant in question is exposed to a YSoD (in this case, an ill-formed error message page), or others are exposed to a potential YSoD.</p>
<p>In this case, search queries are recorded in the MT logs, and are viewable by someone with Admin access.</p>
<p>So this passes the &#8220;not boring&#8221; test, and requires an additional 1-line fix in MT::App::Search-&gt;_straight_search .</p>
<p>My apologies.</p>
<p>Evan wrote:</p>
<blockquote><p>Dagnabit &#8230;!</p></blockquote>
<p>Well, one thing that&#8217;s different now is that there&#8217;s extensive client support for inline SVG. Which is to say, there are &#8212; at least in principle &#8212; non-physicists who might pass your &#8220;<a href='/web/20110811111736/http://www.goer.org/Markup/TheXPhiles/'>Why are you doing this?</a>&#8221; test.</p>
<p>Other than that, nothing has changed &#8230;</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11463" title="March 13, 2008 @ 12:39 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11465"><blockquote><p>My dividing line between boring and interesting is whether only the miscreant in question is exposed to a YSoD (in this case, an ill-formed error message page), or others are exposed to a potential YSoD.</p></blockquote>
<p>Does the &#8220;Testing &amp;?&#8221; link <a href="/web/20110811111736/http://golem.ph.utexas.edu/instiki/authors">here</a> count as exposing others to a potential YSoD? (Incidentally, that suggests an <a href="/web/20110811111736/http://golem.ph.utexas.edu/instiki/new/Testing%20%3Ciframe%20onload=alert(document%26%23x2e;cookie)%3E">XSS hole</a>, though I&#8217;m not sure how to exploit it except in text/html browsers &#8211; XHTML wins on security.)</p>
<p class=sig>&#8212;&#8201;<cite>Philip Taylor</cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11465" title="March 13, 2008 @ 10:48 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li class=me id="comment-11466"><p>> though I&#8217;m not sure how to exploit it</p>
<p>Add quotes around the attribute value and a matching iframe end tag.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://diveintomark.org/' rel='external nofollow' class='url'>Mark</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11466" title="March 13, 2008 @ 11:08 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11467"><blockquote><p>Add quotes around the attribute value and a matching iframe end tag.</p></blockquote>
<p>That would be the quite obvious thing to try, but the difficulty is that an end tag typically requires a slash, and adding slashes to that URL causes a 404, and I can&#8217;t find any way around either of those issues. But it looks like the site is now fixed anyway, so I must find an alternative mechanism for any nefarious schemes.</p>
<p class=sig>&#8212;&#8201;<cite>Philip Taylor</cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11467" title="March 13, 2008 @ 11:40 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11468"><p>Now <em>that</em> was good!</p>
<p>I&#8217;m not 100% happy with my 3-line fix (see Revision 226), but that was a <em>real</em> issue (both were instances of the same issue).</p>
<p>Thanks for pointing it out.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11468" title="March 14, 2008 @ 1:38 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11469"><p>By the way, I&#8217;m unsure that the XSS issue was exploitable, even in text/html. What does an &lt;iframe&gt; inside the &lt;head&gt; do?</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11469" title="March 14, 2008 @ 1:52 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11470"><p>An  inside the  simply gets moved to the body, and then rendered.</p>
<p>Ian Hickson&#8217;s <a href="/web/20110811111736/http://software.hixie.ch/utilities/js/live-dom-viewer/">Live DOM Viewer</a> is helpful for visualizing what transformations your browser&#8217;s internal representation of any given HTML would be.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://intertwingly.net/blog/' rel='external nofollow' class='url'>Sam Ruby</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11470" title="March 14, 2008 @ 3:55 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11471"><p>And of course, an unescaped &lt;iframe&gt; inside a comment on this weblog simply gets eaten by a grue.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://intertwingly.net/blog/' rel='external nofollow' class='url'>Sam Ruby</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11471" title="March 14, 2008 @ 3:58 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11473"><blockquote><p>An &lt;iframe&gt; inside the simply gets moved to the body, and then rendered.</p></blockquote>
<p>That&#8217;s true if it&#8217;s a child of &lt;head&gt;. I should have specified that I was asking about a child of &lt;title&gt; (which is, in turn, a child of &lt;head&gt;)</p>
<blockquote><p>Ian Hickson’s Live DOM Viewer is helpful for visualizing what transformations your browser’s internal representation of any given HTML would be.</p></blockquote>
<p>According to that tool, such an &lt;iframe&gt; does not get moved.</p>
<p>But one would not want to rely on the crazy behaviour of browsers in this regard.</p>
<p class=sig>&#8212;&#8201;<cite>Anonymous</cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11473" title="March 14, 2008 @ 8:56 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11474"><p>&lt;title&gt; can&#8217;t contain tags (&lt; gets treated as a text character, though with extra magic when it&#8217;s followed by &#8220;!&#8211;&#8221;), and nothing can close a &lt;title&gt; except for the string &#8220;&lt;/title&#8221;, so I think that part is reasonably safe. But that page printed the user-input string in a heading too, and IE6 successfully executed the injected script there.</p>
<p>Of course there are problems like <a href="/web/20110811111736/http://golem.ph.utexas.edu/instiki/show/Sandbox">this</a> too.</p>
<p class=sig>&#8212;&#8201;<cite>Philip Taylor</cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11474" title="March 14, 2008 @ 10:06 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11475"><blockquote><p>But that page printed the user-input string in a heading too, and IE6 successfully executed the injected script there.</p></blockquote>
<p>Which is to say that you successfully executed the script against yourself.</p>
<p>On a /show/ page, the string in question appears in the &lt;title&gt; element.</p>
<p>No matter. It needs to be escaped, and now it is.</p>
<blockquote><p>Of course there are problems like this too.</p></blockquote>
<p>Very impressive!</p>
<p>How did you insert alphanumeric characters into <code>request.remote_ip</code> ? I didn&#8217;t think that was possible. Evidently, it is, which explains Revision 228.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11475" title="March 14, 2008 @ 11:59 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11477"><p>By the way, Sam, I expect that your Weblog (which displays remote commenters&#8217; IP addresses) may be vulnerable to the same attack.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11477" title="March 14, 2008 @ 12:05 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11478"><blockquote><p>By the way, Sam, I expect that your Weblog (which displays remote commenters’ IP addresses) may be vulnerable to the same attack.</p></blockquote>
<p>I don&#8217;t believe so, but both you and Phillip are welcome to try.  I don&#8217;t consider my weblog mission critical.  Breaking a page on my weblog is cause for a good laugh, and interesting discussion.</p>
<p>In any case, the reason I don&#8217;t think so is that I take all the user contributed content and pass it through a single function that deals with things like XML&#8217;s limitations and Python&#8217;s ideosyncracies in dealing with Unicode.  If you find a way that breaks my code based on the REMOTE_ADDR, it will probably break my code in the same way when put in the content itself.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://intertwingly.net/blog/' rel='external nofollow' class='url'>Sam Ruby</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11478" title="March 14, 2008 @ 12:51 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11479"><blockquote><p>you successfully executed the script against yourself.</p></blockquote>
<p>and against anyone who innocently clicked on a link I posted anywhere on the web, letting me execute my code on their computer with the security privileges of your domain (hence letting me access their session cookies and transmit them back to me, or letting me send HTTP requests (e.g. to admin pages) with their authentication status, if they are already logged in to your site). And it&#8217;s usually <a href="/web/20110811111736/http://www.google.com/search?q=this%20is%20an%20example">not too hard</a> to make someone just click on a link.</p>
<blockquote><p>How did you (&#8230;removed word to make mod_security happy&#8230;) alphanumeric characters into request.remote_ip ?</p></blockquote>
<p>Rails&#8217; <code>remote_ip</code> returns <code>@env['HTTP_CLIENT_IP']</code>, and the HTTP Client-IP header can contain anything. (A comment in that function says &#8220;Security note: do not use if IP spoofing is a concern for your application.&#8221;, but doesn&#8217;t make it clear that it might not return an IP address at all.)</p>
<blockquote><p>Revision 228</p></blockquote>
<p><a href="/web/20110811111736/http://golem.ph.utexas.edu/instiki/show/Sandbox">Getting closer</a>. <i>(Oh, looks like you fixed it before I finished writing this comment.)</i></p>
<p>(Of course I hope you&#8217;re not unfairly discriminating against people with IPv6 addresses&#8230;)</p>
<p class=sig>&#8212;&#8201;<cite>Philip Taylor</cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11479" title="March 14, 2008 @ 1:26 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11480"><blockquote><p>Rails’ remote_ip returns @env['HTTP_CLIENT_IP'], and the HTTP Client-IP header can contain anything. (A comment in that function says “Security note: do not use if IP spoofing is a concern for your application.”, but doesn’t make it clear that it might not return an IP address at all.)</p></blockquote>
<p>Ah!</p>
<p>Most interesting to know.</p>
<blockquote><p>(Of course I hope you’re not unfairly discriminating against people with IPv6 addresses…)</p></blockquote>
<p>By &#8220;discriminate&#8221;, you mean &#8220;not display their IPV6 address next to their name&#8221;? Alas, my hastily-written fix does discriminate against them in that fashion.</p>
<p>I shall have to remedy that &#8230; (it&#8217;s easy enough).</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11480" title="March 14, 2008 @ 1:37 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11481"><p>What&#8217;s a regexp that matches an IPV6 address (in any of its glorious variations)?</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11481" title="March 14, 2008 @ 2:00 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11482"><p>I think (but haven&#8217;t tested) that the ABNF in <a href="/web/20110811111736/http://www.ietf.org/rfc/rfc2373.txt">RFC 2373</a> corresponds to <code>^[0-9a-fA-F]{1,4}(:[0-9a-fA-F]{1,4})*|[0-9a-fA-F]{1,4}(:[0-9a-fA-F]{1,4})*::([0-9a-fA-F]{1,4}(:[0-9a-fA-F]{1,4})*)?|::([0-9a-fA-F]{1,4}(:[0-9a-fA-F]{1,4})*)?(:[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})?$</code> but I&#8217;m not sure anyone would complain if you used <code>^[0-9a-fA-F.:&lt;]+$</code> instead.</p>
<p class=sig>&#8212;&#8201;<cite>Philip Taylor</cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11482" title="March 14, 2008 @ 2:23 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li class=me id="comment-11483"><p>PerlMonks to the rescue: <a href="/web/20110811111736/http://www.perlmonks.org/?node_id=324473" rel="nofollow">http://www.perlmonks.org/?node_id=324473</a></p>
<p>which leads to <a href="/web/20110811111736/http://search.cpan.org/src/TMONROE/Net-IPv6Addr-0.2/IPv6Addr.pm" rel="nofollow">http://search.cpan.org/src/TMONROE/Net-IPv6Addr-0.2/IPv6Addr.pm</a></p>
<p>which scares the living shit out of me.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://diveintomark.org/' rel='external nofollow' class='url'>Mark</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11483" title="March 14, 2008 @ 4:49 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11484"><p>No need to reinvent the wheel.</p>
<p><code>require 'resolv'<br />
ip.gsub!(Regexp.union(Resolv::IPv4::Regex, Resolv::IPv6::Regex), '') || 'bogus address'</code></p>
<p>seems to work quite well.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11484" title="March 14, 2008 @ 6:31 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11485"><p>Ha ha ha.</p>
<p>Not only does WordPress swallow unpredictable bits or markup, it also swallows bakslashes.</p>
<p>Backslashes!</p>
<p>Teh funny. You&#8217;ll just have to figure out where the &#8216;backslash-0&#8242; goes in the above expression.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://golem.ph.utexas.edu/~distler/blog/' rel='external nofollow' class='url'>Jacques Distler</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11485" title="March 14, 2008 @ 6:41 pm"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
<li id="comment-11506"><p>I really don&#8217;t get the amount HTML info listed. So many compter thingies. How is someone not going to get a file back that was lost? I dont really know english will so help and its<br />
hard to see my past files. ??? Am really confusd. I trid but cant get the past file back.</p>
<p class=sig>&#8212;&#8201;<cite><a href='/web/20110811111736/http://donthaveone/' rel='external nofollow' class='url'>tom faced</a></cite>&#160;<a class=p href="/web/20110811111736/http://diveintomark.org/archives/2008/03/09/no-fury-like-dracon-scorned#comment-11506" title="March 16, 2008 @ 6:47 am"><img alt="#" src=/web/20110811111736im_/http://wearehugh.com/h.png width=8 height=9></a></li>
</ol>
<h3 id=respond>Respond privately</h3>
<p><i>I am no longer accepting public comments on this post, but you can use this form to contact me privately.  (Your message will not be published.)</i></p>
<form action="/web/20110811111736/http://wearehugh.com/public/contact.cgi" method=POST id=commentform>
<p><label for=author>Name </label><br>
<input type=text name=author id=author>
<p><label for=email>Email</label><br>
<input type=text name=email id=email></p>
<p><label for=comment>Message</label>
<textarea name=comment id=comment rows=10 cols=40></textarea></p>
<p><input type=submit value="Send message">
</p>
</form>
<p class=c>&#167;
<div class=f>
<p>
<a title="my comments here and elsewhere" href=/web/20110811111736/http://firehose.diveintomark.org/>firehose</a> &#x2027;
<a title="my current open source projects" href="/web/20110811111736/http://code.google.com/u/@UxdWQ1xUDhhBWwd%2F/">code</a> &#x2027;
<a title="my personal news aggregator" href=/web/20110811111736/http://feeds.diveintomark.org/>planet</a>
<p>&#169; 2001&#8211;present <a accesskey=9 href=/web/20110811111736/http://diveintomark.org/about>Mark Pilgrim</a>
</div>
</body>
</html>

<!-- Dynamic page generated in 0.420 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2011-06-14 01:52:47 -->
<!-- super cache -->




<!--
     FILE ARCHIVED ON 11:17:36 Aug 11, 2011 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 21:05:22 Jan 16, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
